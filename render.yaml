# Render.com Blueprint for Banking AI POC
# This file enables one-click deployment of all 3 services

services:
  # 1. Java Backend Service
  - type: web
    name: banking-backend
    env: java
    region: oregon
    plan: free
    buildCommand: cd backend-java/banking-backend && mvn clean package -DskipTests
    startCommand: cd backend-java/banking-backend && java -jar target/banking-backend-0.0.1-SNAPSHOT.jar
    healthCheckPath: /api/balance?accountId=123
    envVars:
      - key: SERVER_PORT
        value: 8081
      - key: JAVA_OPTS
        value: -Xmx512m
    
  # 2. AI Orchestrator Service
  - type: web
    name: banking-orchestrator
    env: python
    region: oregon
    plan: free
    buildCommand: cd ai-orchestrator && pip install -r requirements_v2.txt
    startCommand: cd ai-orchestrator && uvicorn server_v2:app --host 0.0.0.0 --port 8000
    healthCheckPath: /health
    envVars:
      - key: BACKEND_URL
        fromService:
          type: web
          name: banking-backend
          property: host
      - key: PORT
        value: 8000
      - key: PYTHONUNBUFFERED
        value: 1
    
  # 3. Streamlit UI Service
  - type: web
    name: banking-ui
    env: python
    region: oregon
    plan: free
    buildCommand: cd ui && pip install -r requirements.txt
    startCommand: cd ui && streamlit run ui_v2.py --server.port 8501 --server.address 0.0.0.0
    envVars:
      - key: ORCHESTRATOR_URL
        fromService:
          type: web
          name: banking-orchestrator
          property: host
      - key: PORT
        value: 8501

databases:
  # SQLite runs in-container (for demo)
  # For production, add PostgreSQL:
  # - type: pserv
  #   name: banking-db
  #   plan: free
